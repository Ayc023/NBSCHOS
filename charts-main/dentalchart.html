<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dental Records Charts</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Overall page styling */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f5f9;
            color: #333;
            text-align: center;
            padding: 20px;
        }

        h1 {
            color: #0066cc;
            font-size: 2.8rem;
            margin-bottom: 30px;
            font-weight: 600;
        }
        /* Back button styling */
        .back-button {
            background-color: #1535ee; /* Your preferred button color */
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 1rem;
            cursor: pointer;
            margin-bottom: 20px; /* Space below the button */
            text-decoration: none; /* No underline for link */
        }

        .back-button:hover {
            background-color: #004080; /* Darker shade on hover */
        }

        /* Flex container for charts */
        .charts-wrapper {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        /* Chart container styling */
        .chart-container {
            flex: 1 1 45%;
            min-width: 300px;
            max-width: 600px;
            margin: 20px;
            padding: 25px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        /* Hover effect for charts */
        .chart-container:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.12);
        }

        /* Custom chart canvas styling */
        canvas {
            border-radius: 10px;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .chart-container {
                flex: 1 1 100%; /* On smaller screens, charts will stack vertically */
            }
        }
    </style>
</head>
<body>
    <h1>Dental Records Data Visualization</h1>
    <a href="chartdisplay.html" class="back-button">Back</a>
    <div class="charts-wrapper">
        <div class="chart-container">
            <canvas id="barChart"></canvas>
        </div>

        <div class="chart-container">
            <canvas id="pieChart"></canvas>
        </div>

        <div class="chart-container">
            <canvas id="lineChart"></canvas>
        </div>

        <div class="chart-container">
            <canvas id="areaChart"></canvas>
        </div>
    </div>

    <script>
        // Fetch data from PHP using AJAX
        fetch('fetch_dental.php')
            .then(response => response.json())
            .then(data => {
                const weeklyPatients = {};
                const monthlyPatients = {};
                const yearlyPatients = {};

                // Organize data into weekly, monthly, and yearly counts
                data.weekly.forEach(record => {
                    const label = `Year ${record.year}, Week ${record.week}`;
                    weeklyPatients[label] = record.patient_count;
                });

                data.monthly.forEach(record => {
                    const label = `Year ${record.year}, Month ${record.month}`;
                    monthlyPatients[label] = record.patient_count;
                });

                data.yearly.forEach(record => {
                    const label = `Year ${record.year}`;
                    yearlyPatients[label] = record.patient_count;
                });

                // 1. Bar Chart - Weekly Patients
                const barCtx = document.getElementById('barChart').getContext('2d');
                new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(weeklyPatients),
                        datasets: [{
                            label: 'Weekly Patients',
                            data: Object.values(weeklyPatients),
                            backgroundColor: 'rgba(0, 123, 255, 0.7)',
                            borderColor: 'rgba(0, 123, 255, 1)',
                            borderWidth: 1,
                            hoverBackgroundColor: 'rgba(0, 123, 255, 1)',
                            hoverBorderColor: 'rgba(0, 123, 255, 1)'
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(200, 200, 200, 0.1)',
                                },
                                ticks: {
                                    color: '#666',
                                    font: {
                                        size: 14,
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    color: '#666',
                                    font: {
                                        size: 14,
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#333',
                                    font: {
                                        size: 16,
                                        weight: 'bold'
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 123, 255, 0.9)',
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 }
                            }
                        }
                    }
                });

                // 2. Pie Chart - Monthly Patients
                const pieCtx = document.getElementById('pieChart').getContext('2d');
                new Chart(pieCtx, {
                    type: 'pie',
                    data: {
                        labels: Object.keys(monthlyPatients),
                        datasets: [{
                            label: 'Monthly Patients',
                            data: Object.values(monthlyPatients),
                            backgroundColor: [
                                '#36A2EB', '#FF6384', '#FFCE56', '#4BC0C0', '#9966FF',
                                '#FF9F40', '#FF6384', '#36A2EB', '#FFCE56'
                            ],
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#333',
                                    font: {
                                        size: 14
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(54, 162, 235, 0.85)',
                                bodyFont: { size: 13 }
                            }
                        }
                    }
                });

                // 3. Line Chart - Yearly Patients
                const lineCtx = document.getElementById('lineChart').getContext('2d');
                new Chart(lineCtx, {
                    type: 'line',
                    data: {
                        labels: Object.keys(yearlyPatients),
                        datasets: [{
                            label: 'Yearly Patients',
                            data: Object.values(yearlyPatients),
                            backgroundColor: 'rgba(255, 206, 86, 0.2)',
                            borderColor: 'rgba(255, 206, 86, 1)',
                            fill: false,
                            borderWidth: 2,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            tension: 0.4 // for smoother lines
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(200, 200, 200, 0.1)',
                                },
                                ticks: {
                                    color: '#666',
                                    font: {
                                        size: 14,
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    color: '#666',
                                    font: {
                                        size: 14,
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#333',
                                    font: {
                                        size: 16,
                                        weight: 'bold'
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 206, 86, 0.85)',
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 }
                            }
                        }
                    }
                });

                // 4. Area Chart - Weekly Patients Trend (as an example)
                const areaCtx = document.getElementById('areaChart').getContext('2d');
                new Chart(areaCtx, {
                    type: 'line',
                    data: {
                        labels: Object.keys(weeklyPatients),
                        datasets: [{
                            label: 'Weekly Patients Area Chart',
                            data: Object.values(weeklyPatients),
                            backgroundColor: 'rgba(153, 102, 255, 0.2)',
                            borderColor: 'rgba(153, 102, 255, 1)',
                            fill: true,
                            borderWidth: 1,
                            pointRadius: 3,
                            pointHoverRadius: 5,
                            tension: 0.3 // for smoother curves
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(200, 200, 200, 0.1)',
                                },
                                ticks: {
                                    color: '#666',
                                    font: {
                                        size: 14,
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    color: '#666',
                                    font: {
                                        size: 14,
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#333',
                                    font: {
                                        size: 16,
                                        weight: 'bold'
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(153, 102, 255, 0.85)',
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 }
                            }
                        }
                    }
                });
            });
    </script>
</body>
</html>
